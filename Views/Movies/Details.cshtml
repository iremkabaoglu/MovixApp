@model MovixApp.Models.Movie
@{
    var title = Model?.Title ?? "Film";
    ViewData["Title"] = title;

    string? poster = !string.IsNullOrWhiteSpace(Model?.PosterPath)
        ? $"https://image.tmdb.org/t/p/w780{Model!.PosterPath}"
        : null;
}

<div class="content-inner">
    @* ÖNEMLİ: container yerine bu *@
    <div class="row g-4 align-items-start">

        <!-- POSTER -->
        <div class="col-12 col-md-5 col-lg-4">
            @if (!string.IsNullOrEmpty(poster))
            {
                <img src="@poster"
                     alt="@title"
                     class="img-fluid rounded shadow"
                     onerror="this.style.display='none'">
            }
            else
            {
                <div class="bg-dark border border-secondary rounded d-flex align-items-center justify-content-center"
                     style="height:480px;">
                    <span class="text-secondary">Poster bulunamadı</span>
                </div>
            }
        </div>

        <!-- BİLGİLER -->
        <div class="col-12 col-md-7 col-lg-8">
            <h2 class="mb-2">@title</h2>

            <div class="d-flex align-items-center mb-3">
                <span class="me-2">⭐</span>
                <span class="fw-semibold">@Model?.VoteAverage.ToString("0.0")</span>
                <span class="text-secondary ms-2">(TMDB)</span>
            </div>

            <div class="card bg-black border-0 shadow-sm mb-3">
                <div class="card-body">
                    <h6 class="text-secondary mb-2">Özet</h6>
                    <p class="movie-summary mb-0">
                        @(string.IsNullOrWhiteSpace(Model?.Overview)
                            ? "Bu film için özet bilgisi bulunamadı."
                            : Model!.Overview)
                    </p>
                </div>
            </div>

            <div class="d-flex flex-wrap gap-2">
                <a asp-controller="Movies" asp-action="Index" class="btn btn-outline-light btn-sm">
                    ← Listeye Dön
                </a>
                @if (Model == null)
                {
                    <p>Film bulunamadı.</p>
                }
                else if (User?.Identity != null && User.Identity.IsAuthenticated)
                {
                    <form asp-controller="Favorites" asp-action="Add" method="post" class="d-inline">
                        <input type="hidden" name="movieId" value="@Model!.Id" />
                        <button type="submit" class="btn btn-main btn-sm">
                            ❤️ Favorilere Ekle
                        </button>
                    </form>
                }
                else
                {
                    <a asp-area="Identity" asp-page="/Account/Login" class="btn btn-main btn-sm">
                        ❤️ Favorilere Ekle (Giriş Yap)
                    </a>
                }
                <button type="button" class="btn btn-outline-light btn-sm" disabled title="Yakında">
                    ✔️ İzledim
                </button>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // gerekirse ileride trailer/oyuncular yükleme
    </script>
}
